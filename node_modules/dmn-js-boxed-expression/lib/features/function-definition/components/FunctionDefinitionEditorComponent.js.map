{"version":3,"file":"FunctionDefinitionEditorComponent.js","names":["is","withChangeSupport","EditButton","FunctionDefinitionComponentProvider","$inject","constructor","components","onGetComponent","expression","FunctionDefinitionEditorComponent","_FunctionDefinitionEditorComponent","props","context","functionDefinition","injector","get","contextMenu","kind","getKind","parameters","getParameters","body","getBody","openKindEditor","event","position","getParentPosition","open","contextMenuType","openFormalParametersEditor","createVNode","createComponentVNode","Kind","FormalParameters","BodyExpression","KIND_MAP","openEditor","translate","null","createTextVNode","reduce","acc","parameter","concat","Parameter","slice","_Parameter","name","typeRef","displayedName","_BodyExpression","Expression","getComponent","parent","target","parentElement","bbox","getBoundingClientRect","x","y"],"sources":["../../../../src/features/function-definition/components/FunctionDefinitionEditorComponent.js"],"sourcesContent":["import { is } from 'dmn-js-shared/lib/util/ModelUtil';\n\nimport { withChangeSupport } from '../../../util/withChangeSupport';\nimport { EditButton } from '../../../components/EditButton';\n\nexport class FunctionDefinitionComponentProvider {\n  static $inject = [ 'components' ];\n\n  constructor(components) {\n    components.onGetComponent('expression', ({ expression }) => {\n      if (is(expression, 'dmn:FunctionDefinition')) {\n        return FunctionDefinitionEditorComponent;\n      }\n    });\n  }\n}\n\nconst FunctionDefinitionEditorComponent = withChangeSupport(\n  _FunctionDefinitionEditorComponent,\n  props => [ props.expression ]\n);\n\n\nfunction _FunctionDefinitionEditorComponent({ expression }, context) {\n  const functionDefinition = context.injector.get('functionDefinition');\n  const contextMenu = context.injector.get('contextMenu');\n\n  const kind = functionDefinition.getKind(expression);\n  const parameters = functionDefinition.getParameters(expression);\n  const body = functionDefinition.getBody(expression);\n\n  const openKindEditor = event => {\n    const position = getParentPosition(event);\n    contextMenu.open(position, {\n      contextMenuType: 'kind-editor',\n      expression\n    });\n  };\n  const openFormalParametersEditor = event => {\n    const position = getParentPosition(event);\n    contextMenu.open(position, {\n      contextMenuType: 'formal-parameters-editor',\n      expression\n    });\n  };\n\n  return (\n    <div className=\"function-definition\">\n      <Kind kind={ kind } openEditor={ openKindEditor } />\n      <FormalParameters\n        parameters={ parameters }\n        openEditor={ openFormalParametersEditor }\n      />\n      <BodyExpression expression={ body } parameters={ parameters } />\n    </div>\n  );\n}\n\nconst KIND_MAP = {\n  'FEEL': 'F',\n  'Java': 'J',\n  'PMML': 'P'\n};\n\nfunction Kind({ kind, openEditor }, context) {\n  const translate = context.injector.get('translate');\n\n  return (\n    <div className=\"function-definition-kind\">\n      { KIND_MAP[kind] }\n      <EditButton label={ translate('Edit function kind') } onClick={ openEditor } />\n    </div>\n  );\n}\n\nfunction FormalParameters({ openEditor, parameters }, context) {\n  const translate = context.injector.get('translate');\n\n  return (\n    <div className=\"function-definition-parameters\">\n      <div>\n        (\n        {\n          parameters.reduce((acc, parameter) => {\n            return acc.concat(<Parameter parameter={ parameter } />, ', ');\n          }, []).slice(0, -1)\n        }\n        )\n      </div>\n      <EditButton label={ translate('Edit formal parameters') } onClick={ openEditor } />\n    </div>\n  );\n}\n\nconst Parameter = withChangeSupport(_Parameter, props => [ props.parameter ]);\n\nfunction _Parameter({ parameter }) {\n  const { name, typeRef } = parameter;\n  const displayedName = name || '<unnamed>';\n\n  return <span>\n    {typeRef ? `${displayedName}: ${typeRef}` : displayedName}\n  </span>;\n}\n\nconst BodyExpression = withChangeSupport(_BodyExpression, props => props.parameters);\n\nfunction _BodyExpression({ expression, parameters }, context) {\n  const Expression = context.components.getComponent('expression', {\n    expression\n  });\n\n  return (\n    <div className=\"function-definition-body\">\n      <Expression expression={ expression } parameters={ parameters } />\n    </div>\n  );\n}\n\nfunction getParentPosition(event) {\n  const parent = event.target.parentElement,\n        bbox = parent.getBoundingClientRect();\n\n  return {\n    x: bbox.x,\n    y: bbox.y\n  };\n}\n"],"mappings":"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","ignoreList":[]}