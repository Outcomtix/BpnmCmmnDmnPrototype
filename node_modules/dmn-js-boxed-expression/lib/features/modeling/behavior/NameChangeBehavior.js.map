{"version":3,"file":"NameChangeBehavior.js","names":["CommandInterceptor","is","NameChangeBehavior","$inject","constructor","eventBus","modeling","_modeling","postExecuted","updateName","context","element","properties","isNameChanged","isVariable","handleVariableNameChange","isVariableContainer","handleVariableContainerNameChange","parent","getParent","get","variable","newName","updateProperties","name","container","$parent"],"sources":["../../../../src/features/modeling/behavior/NameChangeBehavior.js"],"sourcesContent":["import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\r\n\r\nimport {\r\n  is\r\n} from 'dmn-js-shared/lib/util/ModelUtil';\r\n\r\n\r\nexport default class NameChangeBehavior extends CommandInterceptor {\r\n\r\n  static $inject = [ 'eventBus', 'modeling' ];\r\n\r\n  constructor(eventBus, modeling) {\r\n    super(eventBus);\r\n\r\n    this._modeling = modeling;\r\n\r\n    this.postExecuted('element.updateProperties', this.updateName);\r\n  }\r\n\r\n  updateName = ({ context }) => {\r\n    const { element, properties } = context;\r\n\r\n    if (!this.isNameChanged(properties)) {\r\n      return;\r\n    }\r\n\r\n    if (this.isVariable(element)) {\r\n      this.handleVariableNameChange(element);\r\n    } else if (this.isVariableContainer(element)) {\r\n      this.handleVariableContainerNameChange(element);\r\n    }\r\n  };\r\n\r\n  isNameChanged(properties) {\r\n    return 'name' in properties;\r\n  }\r\n\r\n  isVariable(element) {\r\n    const parent = getParent(element);\r\n\r\n    return (\r\n      is(element, 'dmn:InformationItem') &&\r\n      parent && parent.get('variable') === element\r\n    );\r\n  }\r\n\r\n  isVariableContainer(element) {\r\n    const variable = element.get('variable');\r\n\r\n    return variable && is(variable, 'dmn:InformationItem');\r\n  }\r\n\r\n  handleVariableNameChange(variable) {\r\n    const parent = getParent(variable),\r\n          newName = variable.get('name');\r\n\r\n    if (newName === parent.get('name')) {\r\n      return;\r\n    }\r\n\r\n    this._modeling.updateProperties(parent, { name: newName });\r\n  }\r\n\r\n  handleVariableContainerNameChange(container) {\r\n    const variable = container.get('variable'),\r\n          newName = container.get('name');\r\n\r\n    if (variable && newName !== variable.get('name')) {\r\n      this._modeling.updateProperties(variable, { name: newName });\r\n    }\r\n  }\r\n}\r\n\r\n\r\n// helpers //////////////////////\r\n\r\nfunction getParent(element) {\r\n  return element.$parent;\r\n}\r\n"],"mappings":"AAAA,OAAOA,kBAAkB,MAAM,2CAA2C;AAE1E,SACEC,EAAE,QACG,kCAAkC;AAGzC,eAAe,MAAMC,kBAAkB,SAASF,kBAAkB,CAAC;EAEjE,OAAOG,OAAO,GAAG,CAAE,UAAU,EAAE,UAAU,CAAE;EAE3CC,WAAWA,CAACC,QAAQ,EAAEC,QAAQ,EAAE;IAC9B,KAAK,CAACD,QAAQ,CAAC;IAEf,IAAI,CAACE,SAAS,GAAGD,QAAQ;IAEzB,IAAI,CAACE,YAAY,CAAC,0BAA0B,EAAE,IAAI,CAACC,UAAU,CAAC;EAChE;EAEAA,UAAU,GAAGA,CAAC;IAAEC;EAAQ,CAAC,KAAK;IAC5B,MAAM;MAAEC,OAAO;MAAEC;IAAW,CAAC,GAAGF,OAAO;IAEvC,IAAI,CAAC,IAAI,CAACG,aAAa,CAACD,UAAU,CAAC,EAAE;MACnC;IACF;IAEA,IAAI,IAAI,CAACE,UAAU,CAACH,OAAO,CAAC,EAAE;MAC5B,IAAI,CAACI,wBAAwB,CAACJ,OAAO,CAAC;IACxC,CAAC,MAAM,IAAI,IAAI,CAACK,mBAAmB,CAACL,OAAO,CAAC,EAAE;MAC5C,IAAI,CAACM,iCAAiC,CAACN,OAAO,CAAC;IACjD;EACF,CAAC;EAEDE,aAAaA,CAACD,UAAU,EAAE;IACxB,OAAO,MAAM,IAAIA,UAAU;EAC7B;EAEAE,UAAUA,CAACH,OAAO,EAAE;IAClB,MAAMO,MAAM,GAAGC,SAAS,CAACR,OAAO,CAAC;IAEjC,OACEV,EAAE,CAACU,OAAO,EAAE,qBAAqB,CAAC,IAClCO,MAAM,IAAIA,MAAM,CAACE,GAAG,CAAC,UAAU,CAAC,KAAKT,OAAO;EAEhD;EAEAK,mBAAmBA,CAACL,OAAO,EAAE;IAC3B,MAAMU,QAAQ,GAAGV,OAAO,CAACS,GAAG,CAAC,UAAU,CAAC;IAExC,OAAOC,QAAQ,IAAIpB,EAAE,CAACoB,QAAQ,EAAE,qBAAqB,CAAC;EACxD;EAEAN,wBAAwBA,CAACM,QAAQ,EAAE;IACjC,MAAMH,MAAM,GAAGC,SAAS,CAACE,QAAQ,CAAC;MAC5BC,OAAO,GAAGD,QAAQ,CAACD,GAAG,CAAC,MAAM,CAAC;IAEpC,IAAIE,OAAO,KAAKJ,MAAM,CAACE,GAAG,CAAC,MAAM,CAAC,EAAE;MAClC;IACF;IAEA,IAAI,CAACb,SAAS,CAACgB,gBAAgB,CAACL,MAAM,EAAE;MAAEM,IAAI,EAAEF;IAAQ,CAAC,CAAC;EAC5D;EAEAL,iCAAiCA,CAACQ,SAAS,EAAE;IAC3C,MAAMJ,QAAQ,GAAGI,SAAS,CAACL,GAAG,CAAC,UAAU,CAAC;MACpCE,OAAO,GAAGG,SAAS,CAACL,GAAG,CAAC,MAAM,CAAC;IAErC,IAAIC,QAAQ,IAAIC,OAAO,KAAKD,QAAQ,CAACD,GAAG,CAAC,MAAM,CAAC,EAAE;MAChD,IAAI,CAACb,SAAS,CAACgB,gBAAgB,CAACF,QAAQ,EAAE;QAAEG,IAAI,EAAEF;MAAQ,CAAC,CAAC;IAC9D;EACF;AACF;;AAGA;;AAEA,SAASH,SAASA,CAACR,OAAO,EAAE;EAC1B,OAAOA,OAAO,CAACe,OAAO;AACxB","ignoreList":[]}