{"version":3,"file":"Viewer.js","names":["Injector","core","Viewer","constructor","options","injector","modules","config","_init","createInjector","get","invoke","fire","destroy","eventBus","clear","bootstrapModules","concat","init"],"sources":["../../../src/base/viewer/Viewer.js"],"sourcesContent":["import { Injector } from 'didi';\r\n\r\nimport core from './core';\r\n\r\n\r\n/**\r\n * A base for React-style viewers.\r\n */\r\nexport default class Viewer {\r\n\r\n  constructor(options = {}) {\r\n    let {\r\n      injector\r\n    } = options;\r\n\r\n    if (!injector) {\r\n      let { modules, config } = this._init(options);\r\n\r\n      injector = createInjector(config, modules);\r\n    }\r\n\r\n    this.get = injector.get;\r\n\r\n    this.invoke = injector.invoke;\r\n\r\n    this.get('eventBus').fire('viewer.init');\r\n  }\r\n\r\n  /**\r\n   * Intialize and return modules and config used for creation.\r\n   *\r\n   * @param  {Object} options\r\n   *\r\n   * @return {Object} { modules=[], config }\r\n   */\r\n  _init(options) {\r\n    let {\r\n      modules,\r\n      ...config\r\n    } = options;\r\n\r\n    return { modules, config };\r\n  }\r\n\r\n  /**\r\n   * Destroy. This results in removing the attachment from the container.\r\n   */\r\n  destroy() {\r\n    const eventBus = this.get('eventBus');\r\n\r\n    eventBus.fire('viewer.destroy');\r\n  }\r\n\r\n  /**\r\n   * Clear. Should be used to reset the state of any stateful services.\r\n   */\r\n  clear() {\r\n    const eventBus = this.get('eventBus');\r\n\r\n    eventBus.fire('viewer.clear');\r\n  }\r\n\r\n}\r\n\r\n\r\n// helpers //////////////////////\r\n\r\nfunction createInjector(config, modules) {\r\n  const bootstrapModules = [\r\n    {\r\n      config: [ 'value', config ]\r\n    },\r\n    core\r\n  ].concat(modules || []);\r\n\r\n  const injector = new Injector(bootstrapModules);\r\n\r\n  injector.init();\r\n\r\n  return injector;\r\n}\r\n"],"mappings":"AAAA,SAASA,QAAQ,QAAQ,MAAM;AAE/B,OAAOC,IAAI,MAAM,QAAQ;;AAGzB;AACA;AACA;AACA,eAAe,MAAMC,MAAM,CAAC;EAE1BC,WAAWA,CAACC,OAAO,GAAG,CAAC,CAAC,EAAE;IACxB,IAAI;MACFC;IACF,CAAC,GAAGD,OAAO;IAEX,IAAI,CAACC,QAAQ,EAAE;MACb,IAAI;QAAEC,OAAO;QAAEC;MAAO,CAAC,GAAG,IAAI,CAACC,KAAK,CAACJ,OAAO,CAAC;MAE7CC,QAAQ,GAAGI,cAAc,CAACF,MAAM,EAAED,OAAO,CAAC;IAC5C;IAEA,IAAI,CAACI,GAAG,GAAGL,QAAQ,CAACK,GAAG;IAEvB,IAAI,CAACC,MAAM,GAAGN,QAAQ,CAACM,MAAM;IAE7B,IAAI,CAACD,GAAG,CAAC,UAAU,CAAC,CAACE,IAAI,CAAC,aAAa,CAAC;EAC1C;;EAEA;AACF;AACA;AACA;AACA;AACA;AACA;EACEJ,KAAKA,CAACJ,OAAO,EAAE;IACb,IAAI;MACFE,OAAO;MACP,GAAGC;IACL,CAAC,GAAGH,OAAO;IAEX,OAAO;MAAEE,OAAO;MAAEC;IAAO,CAAC;EAC5B;;EAEA;AACF;AACA;EACEM,OAAOA,CAAA,EAAG;IACR,MAAMC,QAAQ,GAAG,IAAI,CAACJ,GAAG,CAAC,UAAU,CAAC;IAErCI,QAAQ,CAACF,IAAI,CAAC,gBAAgB,CAAC;EACjC;;EAEA;AACF;AACA;EACEG,KAAKA,CAAA,EAAG;IACN,MAAMD,QAAQ,GAAG,IAAI,CAACJ,GAAG,CAAC,UAAU,CAAC;IAErCI,QAAQ,CAACF,IAAI,CAAC,cAAc,CAAC;EAC/B;AAEF;;AAGA;;AAEA,SAASH,cAAcA,CAACF,MAAM,EAAED,OAAO,EAAE;EACvC,MAAMU,gBAAgB,GAAG,CACvB;IACET,MAAM,EAAE,CAAE,OAAO,EAAEA,MAAM;EAC3B,CAAC,EACDN,IAAI,CACL,CAACgB,MAAM,CAACX,OAAO,IAAI,EAAE,CAAC;EAEvB,MAAMD,QAAQ,GAAG,IAAIL,QAAQ,CAACgB,gBAAgB,CAAC;EAE/CX,QAAQ,CAACa,IAAI,CAAC,CAAC;EAEf,OAAOb,QAAQ;AACjB","ignoreList":[]}