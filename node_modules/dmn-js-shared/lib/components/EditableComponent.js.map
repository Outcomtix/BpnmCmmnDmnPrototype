{"version":3,"file":"EditableComponent.js","names":["Component","ContentEditable","EditableComponent","constructor","props","context","state","changing","focussed","injector","debounceInput","get","inputChanged","value","onChange","currentValue","setState","onInput","validate","invalid","onFocus","event","onBlur","getClassName","className","getDisplayValue","placeholder","getEditor","createComponentVNode","ctrlForNewline","label"],"sources":["../../src/components/EditableComponent.js"],"sourcesContent":["import { Component } from 'inferno';\n\nimport ContentEditable from './ContentEditable';\n\n\n/**\n * A base component for interactivity.\n *\n * @example\n *\n * class Foo extends EditableComponent {\n *\n *   render() {\n *     return (\n *       <div>{ this.getEditor() }</div>\n *     );\n *   }\n * }\n *\n * And in use:\n *\n * <Foo value={ blub }\n *      onChange={ (newValue) => { ... }\n *      onFocus={ () => { ... } }\n *      onBlur={ () => { ... } }\n *      validate={ (newValue) => { return 'some-error'; } }\n *      className=\"...\" } />\n *\n * Special classes added:\n *\n * * focused\n * * invalid\n *\n */\nexport default class EditableComponent extends Component {\n\n  constructor(props, context) {\n    super(props, context);\n\n    this.state = {\n      changing: false,\n      focussed: false\n    };\n\n\n    const { injector } = context;\n\n    const debounceInput = injector.get('debounceInput');\n\n    this.inputChanged = debounceInput((value) => {\n      const { onChange } = this.props;\n\n      if (typeof onChange === 'function') {\n        onChange(value);\n      }\n\n      // only unset changed if user input and\n      // committed changed value equal. This prevents the\n      // input jumping back to the saved, good value.\n      const currentValue = this.state.changing;\n\n      this.setState({\n        changing: currentValue === value ? false : currentValue\n      });\n    });\n\n    this.onInput = (value) => {\n\n      var validate = this.props.validate || function() {};\n\n      var invalid = validate(value);\n\n      this.setState({\n        changing: value,\n        invalid: invalid\n      });\n\n      if (!invalid) {\n        this.inputChanged(value);\n      }\n    };\n  }\n\n  onFocus = event => {\n    this.setState({\n      focussed: true\n    });\n\n    var { onFocus } = this.props;\n\n    if (typeof onFocus === 'function') {\n      onFocus(event);\n    }\n  };\n\n  onBlur = event => {\n    this.setState({\n      focussed: false\n    });\n\n    const { invalid } = this.state;\n\n    if (invalid) {\n      this.setState({\n        changing: false,\n        invalid: false\n      });\n    }\n\n    const { onBlur } = this.props;\n\n    if (typeof onBlur === 'function') {\n      onBlur(event);\n    }\n  };\n\n  getClassName() {\n    var {\n      className,\n      value\n    } = this.props;\n\n    var {\n      changing,\n      focussed,\n      invalid\n    } = this.state;\n\n    className += ' editable';\n\n    if (focussed) {\n      className += ' focussed';\n    }\n\n    if (invalid) {\n      className += ' invalid';\n    }\n\n    if (!value && !changing) {\n      className += ' empty';\n    }\n\n    return className;\n  }\n\n  getDisplayValue() {\n\n    var {\n      value,\n      placeholder\n    } = this.props;\n\n    var {\n      focussed,\n      changing\n    } = this.state;\n\n    if (typeof changing === 'string') {\n      value = changing;\n    }\n\n    if (!value) {\n      value = focussed ? '' : (placeholder || '');\n    }\n\n    return value;\n  }\n\n  getEditor(props = {}) {\n\n    return (\n      <ContentEditable\n        className={ props.className }\n        ctrlForNewline={ this.props.ctrlForNewline }\n        label={ this.props.label }\n        onFocus={ this.onFocus }\n        onBlur={ this.onBlur }\n        onInput={ this.onInput }\n        value={ this.getDisplayValue() } />\n    );\n  }\n\n}\n"],"mappings":"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","ignoreList":[]}