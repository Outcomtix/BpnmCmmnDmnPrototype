{"version":3,"file":"DescriptionEditor.js","names":["Component","isString","query","domQuery","EditableComponent","DescriptionEditor","constructor","props","context","_elementRegistry","injector","get","_modeling","_changeSupport","changeSupport","id","_element","onElementsChanged","forceUpdate","componentWillMount","componentDidMount","autoFocus","node","editor","getEditor","focus","componentWillUnmount","offElementsChanged","businessObject","description","length","changeDescription","value","updateProperties","render","createVNode","createComponentVNode","Editor","null","getClassName","container"],"sources":["../../../../src/features/description/components/DescriptionEditor.js"],"sourcesContent":["import { Component } from 'inferno';\r\n\r\nimport { isString } from 'min-dash';\r\n\r\nimport { query as domQuery } from 'min-dom';\r\n\r\nimport EditableComponent from 'dmn-js-shared/lib/components/EditableComponent';\r\n\r\nexport default class DescriptionEditor extends Component {\r\n  constructor(props, context) {\r\n    super(props, context);\r\n\r\n    this._elementRegistry = context.injector.get('elementRegistry');\r\n    this._modeling = context.injector.get('modeling');\r\n\r\n    this._changeSupport = this.context.changeSupport;\r\n\r\n    const { id } = this.props.context;\r\n\r\n    this._element = this._elementRegistry.get(id);\r\n  }\r\n\r\n  onElementsChanged = () => {\r\n    this.forceUpdate();\r\n  };\r\n\r\n  componentWillMount() {\r\n    if (this._element) {\r\n      this._changeSupport.onElementsChanged(this._element.id, this.onElementsChanged);\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    const { autoFocus } = this.props.context;\r\n\r\n    if (autoFocus && this.node) {\r\n      const editor = getEditor(this.node);\r\n\r\n      editor.focus();\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    if (this._element) {\r\n      this._changeSupport.offElementsChanged(this._element.id, this.onElementsChanged);\r\n\r\n      const { businessObject } = this._element;\r\n\r\n      const { description } = businessObject;\r\n\r\n      // if empty description remove description\r\n      if (isString(description) && !description.length) {\r\n        this.changeDescription(null);\r\n      }\r\n    }\r\n  }\r\n\r\n  changeDescription = (value) => {\r\n    this._modeling.updateProperties(this._element, {\r\n      description: value\r\n    });\r\n  };\r\n\r\n  render() {\r\n    if (!this._element) {\r\n      return;\r\n    }\r\n\r\n    const { businessObject } = this._element;\r\n\r\n    const { description } = businessObject;\r\n\r\n    if (!isString(description)) {\r\n      return;\r\n    }\r\n\r\n    return (\r\n      <div\r\n        class=\"context-menu-container description-editor\"\r\n        ref={ node => this.node = node }>\r\n        <Editor\r\n          className=\"dms-input\"\r\n          onChange={ this.changeDescription }\r\n          value={ description } />\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nclass Editor extends EditableComponent {\r\n  render() {\r\n    return (\r\n      <div className={ this.getClassName() }>\r\n        {\r\n          this.getEditor()\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n// helpers //////////\r\n\r\nfunction getEditor(container) {\r\n  return domQuery('.content-editable', container);\r\n}"],"mappings":"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","ignoreList":[]}